import{c as k,w as C,a as e,o as n,f as d,F as p,m as x,n as v,t as i,i as j,v as I,j as g,r as m,d as O}from"./app-0rN-RD4x.js";import{U as D}from"./UserLayout-BZwvJO8r.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./wallet-CAijwS9K.js";const B={class:"p-4 max-w-4xl mx-auto"},F={class:"flex justify-between items-center mb-4"},N={class:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2 mb-6"},P=["onClick"],S=["src"],E={class:"text-xs font-semibold text-gray-700 text-center truncate w-full"},G={key:0,class:"bg-white rounded-xl shadow-md p-4 animate-fadeIn"},T={class:"text-lg font-semibold text-blue-700 mb-1"},V={class:"text-gray-600 text-sm mb-4"},$={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mb-4"},A=["onClick"],L=["src"],M={class:"font-semibold text-blue-500 text-sm"},R={class:"text-xs text-gray-500 mt-1"},q={class:"mb-6"},z={__name:"Topup",props:{user:Object,games:Array},setup(b){const s=m(null),o=m(null),c=m(""),a=m(""),u=m("text-green-600"),f=l=>{s.value=l,o.value=null,a.value=""},_=l=>{o.value=l,a.value=""},y=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MRU"}).format(l||0),h=async()=>{if(!s.value||!o.value){a.value="Please select a game and offer first.",u.value="text-red-600";return}if(!c.value){a.value="Please enter your player ID.",u.value="text-red-600";return}try{await O.post("/user/topup",{game_id:s.value.id,offer_id:o.value.id,player_id:c.value,quantity:1},{onSuccess:()=>{a.value="✅ Order submitted successfully!",u.value="text-green-600",o.value=null,c.value=""},onError:l=>{a.value=l.wallet_balance?l.wallet_balance:"Failed to submit order. Please try again.",u.value="text-red-600"}})}catch{a.value="Something went wrong.",u.value="text-red-600"}};return(l,r)=>(n(),k(D,{user:b.user},{default:C(()=>[e("div",B,[e("div",F,[r[2]||(r[2]=e("h2",{class:"text-lg font-semibold text-blue-700"},"Available Games",-1)),e("button",{class:"text-blue-600 hover:text-blue-800 text-xs font-medium",onClick:r[0]||(r[0]=t=>s.value=null)}," Reset ↻ ")]),e("div",N,[(n(!0),d(p,null,x(b.games,t=>(n(),d("div",{key:t.id,onClick:w=>f(t),class:v(["bg-white/80 backdrop-blur-sm rounded-xl shadow-sm hover:shadow-md p-2 cursor-pointer transition hover:-translate-y-1 flex flex-col items-center border",s.value&&s.value.id===t.id?"border-blue-600":"border-transparent"])},[e("img",{src:t.image||"/images/default-game.jpg",class:"w-10 h-10 rounded-full object-cover mb-1"},null,8,S),e("p",E,i(t.name),1)],10,P))),128))]),s.value?(n(),d("div",G,[e("h3",T,i(s.value.name),1),e("p",V,i(s.value.description||"No description available."),1),e("div",$,[(n(!0),d(p,null,x(s.value.offers,t=>(n(),d("div",{key:t.id,onClick:w=>_(t),class:v(["border rounded-xl p-3 text-center cursor-pointer hover:shadow-md transition",o.value&&o.value.id===t.id?"border-blue-600 bg-blue-50":"border-gray-200"])},[e("img",{src:t.image||"/images/default-offer.jpg",class:"w-16 h-16 rounded-full object-cover mx-auto mb-2"},null,8,L),e("p",M,i(t.name),1),e("p",R,i(y(t.price)),1)],10,A))),128))]),e("div",q,[r[3]||(r[3]=e("label",{class:"block text-gray-700 mb-1 font-medium"},"Player ID",-1)),j(e("input",{"onUpdate:modelValue":r[1]||(r[1]=t=>c.value=t),type:"text",placeholder:"Enter your player ID...",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"},null,512),[[I,c.value]])]),e("div",{class:"text-right"},[e("button",{onClick:h,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg shadow transition"}," Confirm Order ")]),a.value?(n(),d("p",{key:0,class:v(["mt-4 text-sm font-medium",u.value])},i(a.value),3)):g("",!0)])):g("",!0)])]),_:1},8,["user"]))}},W=U(z,[["__scopeId","data-v-ebf42ed1"]]);export{W as default};
