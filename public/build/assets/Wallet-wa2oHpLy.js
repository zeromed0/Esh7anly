import{c as S,w as C,a as e,I as B,o,f as a,j as h,t as n,i as T,v as U,n as D,F as R,m as A,x as I,d as p,r as u}from"./app-0rN-RD4x.js";import{U as N}from"./UserLayout-BZwvJO8r.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./wallet-CAijwS9K.js";const j={key:0,class:"text-center text-blue-600 font-medium mb-2"},E={class:"relative bg-gradient-to-r from-blue-700 via-blue-600 to-blue-400 text-white rounded-2xl shadow-2xl p-6 overflow-hidden"},F={class:"relative"},L={class:"text-3xl md:text-4xl font-bold truncate"},M={class:"mt-4 text-xs opacity-80"},W={class:"bg-white rounded-2xl shadow-md p-6"},Y={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2"},z={class:"bg-white rounded-2xl shadow-md p-6"},H={key:0,class:"overflow-x-auto"},G={class:"w-full text-sm text-gray-700 border-t border-gray-200"},O={class:"py-2 px-3 font-mono text-xs truncate"},q={class:"py-2 px-3 text-right text-green-600 font-semibold"},J={class:"py-2 px-3 text-right text-gray-500"},K={key:1,class:"text-center text-gray-400 mt-4"},Q={__name:"Wallet",props:{user:Object,usedVouchers:Array},setup(l){const x=l,d=u(""),i=u(""),m=u("text-green-600"),b=async()=>{if(!d.value.trim()){i.value="Please enter a valid code.",m.value="text-red-600";return}await p.post("/user/wallet/redeem",{code:d.value},{onSuccess:s=>{const t=s.props.redeemedVoucher;t&&(x.user.balance+=t.amount,x.usedVouchers.unshift(t),i.value="Voucher redeemed successfully!",m.value="text-green-600",d.value="")},onError:()=>{i.value="Invalid or already used voucher.",m.value="text-red-600"}})},v=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MRU"}).format(s||0),g=s=>s?new Date(s).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",f=u(0),c=u(0),y=u(!1),w=I(()=>({transform:"translateY("+c.value+"px)",transition:c.value===0?"transform 0.2s ease-out":"none"})),_=s=>{f.value=s.touches[0].clientY},V=s=>{const t=s.touches[0].clientY-f.value;t>0&&t<120&&(c.value=t)},k=()=>{c.value>80&&(y.value=!0,setTimeout(()=>p.visit("/user/wallet",{preserveScroll:!0}),300)),c.value=0};return(s,t)=>(o(),S(N,{user:l.user},{default:C(()=>[e("div",{class:"p-5 md:p-8 max-w-3xl mx-auto w-full space-y-8",onTouchstart:_,onTouchmove:V,onTouchend:k,style:B(w.value)},[y.value?(o(),a("div",j," ðŸ”„ Refreshing... ")):h("",!0),e("div",E,[t[3]||(t[3]=e("div",{class:"absolute inset-0 bg-white/10 blur-2xl"},null,-1)),e("div",F,[t[1]||(t[1]=e("div",{class:"flex justify-between items-center mb-4"},[e("h2",{class:"text-lg font-semibold"},"My Wallet"),e("i",{class:"fas fa-wallet text-2xl"})],-1)),e("p",L,n(v(l.user.balance)),1),t[2]||(t[2]=e("p",{class:"text-sm opacity-90 mt-1"},"Available Balance",-1)),e("div",M,"Card Holder: "+n(l.user.name),1)])]),e("div",W,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Redeem Voucher",-1)),e("div",Y,[T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r),type:"text",placeholder:"Enter voucher code...",class:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"},null,512),[[U,d.value]]),e("button",{onClick:b,class:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-4 py-2 rounded-lg transition"}," Redeem ")]),i.value?(o(),a("p",{key:0,class:D([m.value,"mt-3 text-sm font-medium text-center"])},n(i.value),3)):h("",!0)]),e("div",z,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Voucher History",-1)),l.usedVouchers.length?(o(),a("div",H,[e("table",G,[t[5]||(t[5]=e("thead",null,[e("tr",{class:"text-left border-b bg-gray-50"},[e("th",{class:"py-2 px-3"},"Code"),e("th",{class:"py-2 px-3 text-right"},"Amount"),e("th",{class:"py-2 px-3 text-right"},"Used At")])],-1)),e("tbody",null,[(o(!0),a(R,null,A(l.usedVouchers,r=>(o(),a("tr",{key:r.id,class:"border-b hover:bg-gray-50 transition"},[e("td",O,n(r.code),1),e("td",q,n(v(r.amount)),1),e("td",J,n(g(r.used_at)),1)]))),128))])])])):(o(),a("div",K," No vouchers redeemed yet. "))])],36)]),_:1},8,["user"]))}},te=P(Q,[["__scopeId","data-v-8e751b52"]]);export{te as default};
