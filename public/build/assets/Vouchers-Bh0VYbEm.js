import{c as I,w as J,a as t,t as u,o as i,f as r,i as b,v as f,j as _,F as w,m as C,n as k,h as x,r as m,e as c}from"./app-0rN-RD4x.js";import{A as K}from"./AdminLayout-B31MEDCB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"p-6"},Q={class:"mb-10"},R={key:0,class:"p-4 bg-white rounded shadow mb-6"},W={class:"flex gap-2"},X={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},Y=["onClick"],Z=["src"],ee={class:"font-semibold text-center"},te={class:"text-sm text-gray-500 text-center"},oe=["onClick"],se={class:"flex gap-2 mt-3 flex-wrap justify-center"},le=["onClick"],ne=["onClick"],ie={key:0,class:"mb-10"},ae={class:"text-xl font-semibold mb-4 text-gray-800"},re={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},de=["src"],ue={class:"font-semibold"},ce={class:"text-gray-600 text-sm"},ve={class:"flex gap-2 mt-2 flex-wrap justify-center"},me=["onClick"],pe=["onClick"],ge=["onClick"],he=["onClick"],be={key:0,class:"w-full mt-4 bg-gray-50 p-3 rounded border"},fe={class:"flex gap-2 mb-2"},xe={key:0,class:"max-h-40 overflow-y-auto"},ye={class:"text-gray-700"},_e=["onClick"],we={key:1,class:"text-sm text-gray-500 text-center mt-2"},Ce={class:"mt-6 p-4 border rounded bg-gray-50"},ke={class:"flex gap-2"},Se={__name:"Vouchers",props:{games:Array},setup($){const y=m(!1),v=m({}),p=m({}),d=m({name:"",description:"",image:""}),V=()=>{c(d.value).post("/admin/vouchers",{onSuccess:()=>{d.value={name:"",description:"",image:""},y.value=!1}})},G=()=>{c(d.value).put("/admin/vouchers/game/"+v.value.id,{onSuccess:()=>{v.value={},d.value={name:"",description:"",image:""}}})},O=()=>{v.value={},d.value={name:"",description:"",image:""}},S=s=>{p.value=p.value.id===s.id?{}:s},j=s=>{c({}).post("/admin/vouchers/game/"+s.id+"/toggle-active",{onSuccess:()=>{s.is_active=!s.is_active}})},g=m({}),a=m({game_id:"",name:"",price:"",image:""}),l=m({}),h=m(""),U=()=>{if(!p.value.id)return;a.value.game_id=p.value.id,c(a.value).post("/admin/vouchers/offer",{onSuccess:()=>{a.value={game_id:"",name:"",price:"",image:""}}})},F=()=>{c(a.value).put("/admin/vouchers/offer/"+g.value.id,{onSuccess:()=>{g.value={},a.value={game_id:"",name:"",price:"",image:""}}})},A=s=>{g.value={...s},a.value={...s}},E=()=>{g.value={},a.value={game_id:"",name:"",price:"",image:""}},B=s=>{confirm("هل تريد حذف هذا العرض؟")&&c({}).delete("/admin/vouchers/offer/"+s)},D=s=>{c({}).post("/admin/vouchers/offer/"+s.id+"/toggle-active",{onSuccess:()=>{s.is_active=!s.is_active}})},L=async s=>{if(l.value.id===s.id){l.value={};return}if(l.value={...s},!l.value.voucherCodes||l.value.voucherCodes.length===0){const o=await fetch("/admin/vouchers/offer/"+s.id+"/codes");if(o.ok){const e=await o.json();l.value.voucherCodes=e.codes||[]}else l.value.voucherCodes=[]}},M=()=>{l.value={},h.value=""},N=()=>{if(!h.value||!l.value.id)return;c({code:h.value}).post("/admin/vouchers/offer/"+l.value.id+"/codes",{onSuccess:()=>{l.value.voucherCodes||(l.value.voucherCodes=[]),l.value.voucherCodes.push({id:Date.now(),code:h.value}),h.value=""}})},z=(s,o)=>{c({}).delete("/admin/vouchers/offer/"+l.value.id+"/codes/"+s,{onSuccess:()=>{l.value.voucherCodes.splice(o,1)}})},T=s=>{v.value={...s},d.value={name:s.name,description:s.description,image:s.image},y.value=!0},q=s=>{confirm("هل تريد حذف هذه اللعبة؟")&&c({}).delete("/admin/vouchers/game/"+s)};return(s,o)=>(i(),I(K,null,{default:J(()=>[t("div",P,[o[13]||(o[13]=t("h1",{class:"text-2xl font-bold mb-6 text-gray-800"},"بطاقات الشحن (Vouchers)",-1)),t("section",Q,[t("button",{onClick:o[0]||(o[0]=e=>y.value=!y.value),class:"bg-blue-600 text-white px-4 py-2 rounded mb-4 hover:bg-blue-700 transition"},u(y.value?"إلغاء":"إضافة لعبة جديدة"),1),y.value||v.value.id?(i(),r("div",R,[b(t("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>d.value.name=e),placeholder:"اسم اللعبة",class:"border p-2 rounded w-full mb-2"},null,512),[[f,d.value.name]]),b(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>d.value.description=e),placeholder:"الوصف (اختياري)",class:"border p-2 rounded w-full mb-2"},null,512),[[f,d.value.description]]),b(t("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>d.value.image=e),placeholder:"رابط الصورة (اختياري)",class:"border p-2 rounded w-full mb-2"},null,512),[[f,d.value.image]]),t("div",W,[t("button",{onClick:o[4]||(o[4]=e=>v.value.id?G():V()),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition"},u(v.value.id?"تحديث اللعبة":"حفظ اللعبة"),1),v.value.id?(i(),r("button",{key:0,onClick:O,class:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 transition"},"إلغاء")):_("",!0)])])):_("",!0),t("div",X,[(i(!0),r(w,null,C($.games,e=>(i(),r("div",{key:e.id,class:"bg-white rounded shadow hover:shadow-lg transition cursor-pointer relative flex flex-col items-center p-4",onClick:n=>S(e)},[t("img",{src:e.image||"/images/default-game.png",class:"w-24 h-24 object-cover rounded mb-2"},null,8,Z),t("h2",ee,u(e.name),1),t("p",te,u(e.description),1),t("button",{onClick:x(n=>j(e),["stop"]),class:k([e.is_active?"bg-green-600":"bg-gray-400","absolute top-2 right-2 text-white px-2 py-1 rounded text-xs"])},u(e.is_active?"مفعّل":"معطّل"),11,oe),t("div",se,[t("button",{onClick:x(n=>T(e),["stop"]),class:"bg-yellow-400 text-white px-3 py-1 rounded text-sm hover:bg-yellow-500"}," تعديل ",8,le),t("button",{onClick:x(n=>q(e.id),["stop"]),class:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600"}," حذف ",8,ne)])],8,Y))),128))])]),p.value.id?(i(),r("section",ie,[t("h3",ae,"العروض - "+u(p.value.name),1),t("div",re,[(i(!0),r(w,null,C(p.value.offers,e=>(i(),r("div",{key:e.id,class:"bg-white rounded shadow hover:shadow-lg transition relative flex flex-col items-center p-4"},[t("img",{src:e.image||"/images/default-offer.png",class:"w-24 h-24 object-cover rounded mb-2"},null,8,de),t("h4",ue,u(e.name),1),t("p",ce,u(e.price)+" د.أ",1),t("div",ve,[t("button",{onClick:x(n=>D(e),["stop"]),class:k([e.is_active?"bg-green-600 hover:bg-green-700":"bg-gray-400 hover:bg-gray-500","text-white px-3 py-1 rounded text-sm"])},u(e.is_active?"مفعّل":"معطّل"),11,me),t("button",{onClick:x(n=>A(e),["stop"]),class:"bg-yellow-400 text-white px-3 py-1 rounded hover:bg-yellow-500 text-sm"},"تعديل",8,pe),t("button",{onClick:x(n=>B(e.id),["stop"]),class:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm"},"حذف",8,ge),t("button",{onClick:x(n=>L(e),["stop"]),class:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm"},"الأكواد",8,he)]),l.value.id===e.id?(i(),r("div",be,[o[12]||(o[12]=t("h5",{class:"font-semibold mb-2 text-gray-800 text-center"},"أكواد العرض",-1)),t("div",fe,[b(t("input",{"onUpdate:modelValue":o[5]||(o[5]=n=>h.value=n),placeholder:"أدخل كود جديد",class:"border p-2 rounded w-full"},null,512),[[f,h.value]]),t("button",{onClick:o[6]||(o[6]=n=>N()),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"},"إضافة")]),l.value.voucherCodes&&l.value.voucherCodes.length?(i(),r("ul",xe,[(i(!0),r(w,null,C(l.value.voucherCodes,(n,H)=>(i(),r("li",{key:n.id,class:"flex justify-between items-center mb-1 bg-white p-2 rounded border"},[t("span",ye,u(n.code),1),t("button",{onClick:$e=>z(n.id,H),class:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 text-sm"},"حذف",8,_e)]))),128))])):(i(),r("p",we,"لا توجد أكواد بعد.")),t("button",{onClick:o[7]||(o[7]=n=>M()),class:"mt-3 bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500"}," إغلاق ")])):_("",!0)]))),128))]),t("div",Ce,[b(t("input",{"onUpdate:modelValue":o[8]||(o[8]=e=>a.value.name=e),placeholder:"اسم العرض",class:"border p-2 rounded w-full mb-2"},null,512),[[f,a.value.name]]),b(t("input",{"onUpdate:modelValue":o[9]||(o[9]=e=>a.value.price=e),type:"number",placeholder:"السعر",class:"border p-2 rounded w-full mb-2"},null,512),[[f,a.value.price]]),b(t("input",{"onUpdate:modelValue":o[10]||(o[10]=e=>a.value.image=e),placeholder:"رابط الصورة (اختياري)",class:"border p-2 rounded w-full mb-2"},null,512),[[f,a.value.image]]),t("div",ke,[t("button",{onClick:o[11]||(o[11]=e=>g.value.id?F():U()),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition"},u(g.value.id?"تحديث العرض":"حفظ العرض"),1),g.value.id?(i(),r("button",{key:0,onClick:E,class:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 transition"},"إلغاء")):_("",!0)])])])):_("",!0)])]),_:1}))}};export{Se as default};
