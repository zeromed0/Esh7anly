import{r,c as k,w as j,a as e,i as b,v as A,l as O,o as n,f as d,F as N,m as S,t as a,n as f,j as F,d as U,e as B}from"./app-0rN-RD4x.js";import{A as I}from"./AdminLayout-B31MEDCB.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"p-4 sm:p-6 bg-gray-50 min-h-screen"},T={class:"flex flex-col sm:flex-row gap-2 mb-4 items-start sm:items-center"},V={key:0,class:"overflow-x-auto bg-white shadow-md rounded-lg"},D={class:"w-full text-sm text-gray-700 border-t border-gray-200"},E={class:"px-2 py-2"},R={class:"px-2 py-2"},P={class:"px-2 py-2"},$={class:"px-2 py-2"},z={class:"px-2 py-2"},G={class:"px-2 py-2 font-mono text-xs"},q={class:"px-2 py-2 text-right text-blue-700 font-semibold"},H={class:"px-2 py-2 text-center"},J={class:"px-2 py-2 text-center space-x-1 sm:space-x-2 flex flex-col sm:flex-row justify-center"},K=["onClick","disabled"],Q=["onClick","disabled"],W={key:1,class:"text-center text-gray-500 mt-10"},X={__name:"Orders",props:{orders:Array},setup(h){const _=h,u=r(""),c=r(""),x=r([..._.orders]),m=r([...x.value]),l=r(""),i=r("text-green-600"),y=(o,s,t)=>{if(t==="completed"||t==="rejected"){l.value="⚠️ This order can no longer be updated.",i.value="text-yellow-600";return}if(!confirm("Are you sure you want to mark this order as "+s+"?"))return;B({status:s}).post("/admin/orders/"+o+"/status",{preserveScroll:!0,onSuccess:()=>{l.value=s==="completed"?"✅ Order completed.":"⚠️ Order rejected and refunded.",i.value=s==="completed"?"text-green-600":"text-yellow-600",setTimeout(()=>l.value="",3e3),v()},onError:()=>{l.value="❌ Failed to update order status.",i.value="text-red-600"}})},w=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MRU"}).format(o||0),g=()=>{m.value=x.value.filter(o=>{const s=Object.values(o).some(p=>String(p).toLowerCase().includes(u.value.toLowerCase())),t=!c.value||o.status===c.value;return s&&t})},v=()=>{U.reload()};return(o,s)=>(n(),k(I,null,{default:j(()=>[e("div",M,[s[4]||(s[4]=e("h1",{class:"text-2xl font-semibold text-gray-800 mb-4 sm:mb-6"},"Manage Orders",-1)),e("div",T,[b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),onInput:g,placeholder:"بحث...",class:"border p-2 rounded w-full sm:w-1/3"},null,544),[[A,u.value]]),b(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>c.value=t),onChange:g,class:"border p-2 rounded w-full sm:w-1/4"},[...s[2]||(s[2]=[e("option",{value:""},"الكل",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"completed"},"Completed",-1),e("option",{value:"rejected"},"Rejected",-1)])],544),[[O,c.value]]),e("button",{onClick:v,class:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 transition"}," تحديث ")]),m.value.length?(n(),d("div",V,[e("table",D,[s[3]||(s[3]=e("thead",{class:"bg-gray-100"},[e("tr",{class:"text-left"},[e("th",{class:"px-2 py-2"},"#"),e("th",{class:"px-2 py-2"},"User"),e("th",{class:"px-2 py-2"},"Email"),e("th",{class:"px-2 py-2"},"Game"),e("th",{class:"px-2 py-2"},"Offer"),e("th",{class:"px-2 py-2"},"Player ID"),e("th",{class:"px-2 py-2 text-right"},"Amount"),e("th",{class:"px-2 py-2 text-center"},"Status"),e("th",{class:"px-2 py-2 text-center"},"Actions")])],-1)),e("tbody",null,[(n(!0),d(N,null,S(m.value,(t,p)=>(n(),d("tr",{key:t.id,class:"border-b hover:bg-gray-50 transition"},[e("td",E,a(p+1),1),e("td",R,a(t.user?.name||"N/A"),1),e("td",P,a(t.user?.email||"N/A"),1),e("td",$,a(t.game?.name||"N/A"),1),e("td",z,a(t.offer?.name||t.offer_name||"N/A"),1),e("td",G,a(t.player_id),1),e("td",q,a(w(t.total_price||t.price)),1),e("td",H,[e("span",{class:f(["px-3 py-1 rounded-full text-xs font-semibold",{"bg-yellow-100 text-yellow-700":t.status==="pending","bg-green-100 text-green-700":t.status==="completed","bg-red-100 text-red-700":t.status==="rejected"}])},a(t.status),3)]),e("td",J,[e("button",{onClick:C=>y(t.id,"completed",t.status),disabled:t.status!=="pending",class:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 text-xs sm:text-sm"}," Complete ",8,K),e("button",{onClick:C=>y(t.id,"rejected",t.status),disabled:t.status!=="pending",class:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 text-xs sm:text-sm"}," Reject ",8,Q)])]))),128))])])])):(n(),d("div",W," No orders available. ")),l.value?(n(),d("p",{key:2,class:f(["text-center mt-4 font-medium transition",i.value])},a(l.value),3)):F("",!0)])]),_:1}))}},te=L(X,[["__scopeId","data-v-b7728451"]]);export{te as default};
