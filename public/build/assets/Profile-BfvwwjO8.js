import{r,c as J,w as R,a as e,t as i,h as D,i as f,v as w,o as c,f as p,j as y,k as I,u as g,n as z,d as b}from"./app-0rN-RD4x.js";import{U as O}from"./UserLayout-BZwvJO8r.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./wallet-CAijwS9K.js";const q={class:"min-h-screen p-5 md:p-10 flex justify-center"},G={class:"w-full max-w-2xl space-y-6"},H={class:"bg-white rounded-2xl shadow-lg p-6"},K={class:"flex items-center gap-4"},Q=["src"],X={class:"flex-1"},Y={class:"flex items-center justify-between"},Z={class:"text-lg font-semibold"},ee={class:"text-sm text-gray-500"},te={class:"text-xs text-gray-400 mt-1"},se={class:"text-xs text-gray-400 mt-1"},ae={class:"text-right"},le={class:"mt-4 flex gap-3"},oe={key:0,class:"mt-4 border-t pt-4"},ne={class:"bg-white rounded-2xl shadow-lg p-6"},de={class:"flex items-start justify-between"},re={class:"text-sm text-gray-600 mt-1"},ie={key:0,class:"text-yellow-600"},ue={key:1,class:"text-green-600"},ce={key:2,class:"text-red-600"},pe={key:3,class:"text-gray-600"},ve={class:"text-right"},xe={class:"text-sm text-gray-500"},me={class:"text-xs text-gray-400 mt-1"},fe={class:"mt-4"},we={class:"mb-3"},ye={class:"mb-3"},ge={class:"flex gap-2 items-center mt-3"},be={class:"grid grid-cols-3 gap-4"},_e={class:"bg-white rounded-2xl shadow p-4 text-center"},he={class:"text-lg font-bold text-blue-600"},ke={class:"bg-white rounded-2xl shadow p-4 text-center"},Ce={class:"text-lg font-bold text-blue-600"},Se={class:"bg-white rounded-2xl shadow p-4 text-center"},Ue={class:"text-lg font-bold text-blue-600"},De={__name:"Profile",props:{user:Object,balance:Number,transactionsCount:Number,usedToday:Number,dailyLimit:Number},setup(l){const u=l,_=r({name:u.user.name||""}),v=r(!1),o=r({current_password:"",password:"",password_confirmation:""}),C=r(null),N=()=>C.value.click(),x=r(null),m=r(null),h=r(null),k=r(null),n=r(""),d=r("text-green-600"),V=u.balance,F=u.transactionsCount,P=u.usedToday,j=u.dailyLimit,S=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=s=>x.value=s.target.files[0]||null,A=s=>m.value=s.target.files[0]||null,U=s=>{s==="identity"&&u.user.identity_card&&window.open("/storage/"+u.user.identity_card,"_blank"),s==="selfie"&&u.user.selfie&&window.open("/storage/"+u.user.selfie,"_blank")},E=()=>{b.patch("/user/profile",{name:_.value.name},{onSuccess:()=>{n.value="Name updated",d.value="text-green-600"},onError:s=>{n.value=s.name?s.name[0]:"Failed",d.value="text-red-600"}})},L=()=>{b.patch("/user/profile/password",{...o.value},{onSuccess:()=>{n.value="Password changed",d.value="text-green-600",o.value.current_password="",o.value.password="",o.value.password_confirmation="",v.value=!1},onError:s=>{n.value=s.password?s.password[0]:s.current_password?s.current_password[0]:"Failed",d.value="text-red-600"}})},B=()=>{o.value.current_password="",o.value.password="",o.value.password_confirmation="",v.value=!1},M=s=>{const t=s.target.files[0];if(!t)return;const a=new FormData;a.append("avatar",t),b.post("/user/profile/avatar",a,{onSuccess:()=>{n.value="Avatar updated",d.value="text-green-600"},onError:()=>{n.value="Avatar upload failed",d.value="text-red-600"}})},$=()=>{const s=new FormData;if(x.value&&s.append("identity_card",x.value),m.value&&s.append("selfie",m.value),!x.value&&!m.value){n.value="Please choose at least one file to upload",d.value="text-red-600";return}b.post("/user/profile/identity",s,{onSuccess:()=>{n.value="Documents uploaded â€” awaiting review",d.value="text-green-600",h.value&&(h.value.value=""),k.value&&(k.value.value=""),x.value=null,m.value=null},onError:t=>{const a=t.identity?t.identity[0]:t.selfie?t.selfie[0]:"Upload failed";n.value=a,d.value="text-red-600"}})};return(s,t)=>(c(),J(O,{user:l.user},{default:R(()=>[e("div",q,[e("div",G,[e("div",H,[e("div",K,[e("img",{src:l.user.avatar?"/storage/"+l.user.avatar:"/images/default-avatar.png",class:"w-20 h-20 rounded-full border-4 border-blue-500 shadow"},null,8,Q),e("div",X,[e("div",Y,[e("div",null,[e("h2",Z,i(l.user.name),1),e("p",ee,i(l.user.email),1),e("p",te,"User ID: "+i(l.user.id),1),e("p",se,"Joined: "+i(S(l.user.created_at)),1)]),e("div",ae,[e("button",{onClick:N,class:"text-sm px-3 py-1 border rounded"},"Change photo"),e("input",{ref_key:"avatarInput",ref:C,type:"file",class:"hidden",onChange:M},null,544)])]),e("div",le,[e("form",{onSubmit:D(E,["prevent"]),class:"flex gap-2 items-center"},[f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>_.value.name=a),class:"border rounded px-3 py-2 text-sm"},null,512),[[w,_.value.name]]),t[7]||(t[7]=e("button",{type:"submit",class:"bg-blue-600 text-white px-3 py-2 rounded text-sm"},"Save",-1))],32),e("button",{onClick:t[1]||(t[1]=a=>v.value=!v.value),class:"text-sm px-3 py-2 border rounded"},"Change password")])])]),v.value?(c(),p("div",oe,[e("form",{onSubmit:D(L,["prevent"]),class:"space-y-3"},[e("div",null,[t[8]||(t[8]=e("label",{class:"text-xs text-gray-600"},"Current password",-1)),f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.current_password=a),type:"password",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[w,o.value.current_password]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs text-gray-600"},"New password",-1)),f(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value.password=a),type:"password",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[w,o.value.password]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-xs text-gray-600"},"Confirm new",-1)),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>o.value.password_confirmation=a),type:"password",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[w,o.value.password_confirmation]])]),e("div",{class:"flex gap-2"},[t[11]||(t[11]=e("button",{class:"bg-green-600 text-white px-3 py-2 rounded text-sm"},"Update password",-1)),e("button",{type:"button",onClick:B,class:"text-sm px-3 py-2 border rounded"},"Cancel")])],32)])):y("",!0)]),e("div",ne,[e("div",de,[e("div",null,[t[13]||(t[13]=e("h3",{class:"font-semibold"},"Verification",-1)),e("p",re,[t[12]||(t[12]=I(" Status: ",-1)),l.user.identity_status==="pending"?(c(),p("span",ie,"Pending review")):l.user.identity_status==="approved"?(c(),p("span",ue,"Approved")):l.user.identity_status==="rejected"?(c(),p("span",ce,"Rejected")):(c(),p("span",pe,"Not uploaded"))])]),e("div",ve,[e("p",xe,[t[14]||(t[14]=I("Daily limit: ",-1)),e("strong",null,i(g(j)),1)]),e("p",me,"Used today: "+i(g(P)),1)])]),e("div",fe,[e("div",we,[t[15]||(t[15]=e("label",{class:"text-sm"},"Identity card (front)",-1)),e("input",{ref_key:"idInput",ref:h,type:"file",onChange:T,class:"w-full mt-2"},null,544)]),e("div",ye,[t[16]||(t[16]=e("label",{class:"text-sm"},"Selfie holding ID + phone",-1)),e("input",{ref_key:"selfieInput",ref:k,type:"file",onChange:A,class:"w-full mt-2"},null,544)]),e("div",ge,[e("button",{onClick:$,class:"bg-blue-600 text-white px-4 py-2 rounded text-sm"}," Upload Documents "),l.user.identity_card?(c(),p("button",{key:0,onClick:t[5]||(t[5]=a=>U("identity")),class:"text-sm px-3 py-1 border rounded"},"View identity")):y("",!0),l.user.selfie?(c(),p("button",{key:1,onClick:t[6]||(t[6]=a=>U("selfie")),class:"text-sm px-3 py-1 border rounded"},"View selfie")):y("",!0)]),n.value?(c(),p("p",{key:0,class:z([d.value,"mt-3 text-sm"])},i(n.value),3)):y("",!0)])]),e("div",be,[e("div",_e,[t[17]||(t[17]=e("p",{class:"text-xs text-gray-500"},"Wallet",-1)),e("p",he,i(g(V))+" MRU",1)]),e("div",ke,[t[18]||(t[18]=e("p",{class:"text-xs text-gray-500"},"Transactions",-1)),e("p",Ce,i(g(F)),1)]),e("div",Se,[t[19]||(t[19]=e("p",{class:"text-xs text-gray-500"},"Joined",-1)),e("p",Ue,i(S(l.user.created_at)),1)])])])])]),_:1},8,["user"]))}},Pe=W(De,[["__scopeId","data-v-a3da1638"]]);export{Pe as default};
